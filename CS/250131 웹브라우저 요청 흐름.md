# 웹 브라우저 요청 흐름
URL 입력 → DNS 조회(IP 반환) → 서버 연결(TCP) → HTTP 요청 → 서버 처리 → HTTP 응답 → 렌더링 → 화면 표시

<br>

---

<br>

## 1. **URL 입력**

사용자가 브라우저의 주소창에 URL(예: `https://www.example.com`)을 입력

### **과정**

- URL이 어떤 종류의 리소스를 요청하는지를 나타냄.
    - `https://`: 프로토콜 (HTTPS 사용).
    - `www.example.com`: 도메인 이름 (호스트).
    - `/path/resource`: 특정 리소스를 가리키는 경로.
- 브라우저는 사용자가 입력한 내용을 **URI 형식**으로 인식하고 처리 준비를 시작

- **URL**: 리소스의 **위치(주소)**를 포함.  / 주소
- **URI**: 리소스의 **식별자**(주소 포함). / 신분증 번호
- 모든 **URL은 URI**지만, **모든 URI가 URL은 아님.**

---

## 2. **DNS 조회**

브라우저는 도메인 이름(`www.example.com`)을 IP 주소로 변환하기 위해 DNS(Domain Name System)에 쿼리를 보내서 IP주소를 반환

### **과정**

1. **브라우저 캐시 확인**: 이미 IP 주소가 캐시에 있다면 DNS 요청 없이 사용.
2. **OS 캐시 확인**: 브라우저에서 찾지 못하면 OS의 DNS 캐시를 확인.
3. **DNS 서버 조회**: 캐시에서 찾지 못하면 설정된 DNS 서버(예: ISP의 DNS 서버)에 쿼리를 전송.
4. **계층적 DNS 조회**:
    - 루트 네임서버 → TLD 네임서버 → 권한 있는 네임서버 순으로 진행.
    - 최종적으로 IP 주소를 얻음.

결과: 예를 들어 `93.184.216.34`라는 IP 주소가 반환

---

- IP는 순서도 바뀔수도 있고 패킷이 손상될수도 있고 이를 보완하는게 TCP
- TCP 패킷이 손실될 경우 재전송하기 때문에 신뢰성도 높고 순서도 보장하고 중복도 방지하고 오류 검출 기능도 있음.

## 3. **TCP 연결**

- **신뢰성 있는 데이터 전송**을 보장하는 프로토콜
- 브라우저는 얻은 IP 주소로 서버와 TCP 연결을 설정
- 데이터를 **패킷(Packet)** 단위로 나누어 전송

### **과정**

1. **3-Way Handshake**:
    - TCP/IP 네트워크에서 안정적이고 연결 지향적인 통신을 설정하기 위해 사용되는 절차.
    - 클라이언트가 서버에 SYN 패킷을 보냄. / "나와 연결을 맺을 준비가 되었나요?”
    - 서버가 SYN-ACK 패킷을 응답. / "좋아요, 연결 준비가 되었어요!”
    - 클라이언트가 ACK 패킷을 보내 연결 확립. / "확인했습니다. 이제 데이터를 주고받을 수 있습니다!”
2. HTTPS라면, **TLS 핸드셰이크**가 추가로 진행됩니다:
    - 클라이언트와 서버가 인증서를 교환하고 암호화 키를 설정.

---

## 4. **HTTP 요청 전송**

TCP 연결이 확립되면 브라우저는 HTTP/HTTPS 프로토콜을 사용해 요청을 전송

### **과정**

- **요청 메시지** 구성:
    - **요청 라인**: `GET /path/resource HTTP/1.1`
    - **헤더**: 클라이언트 정보, 인증 정보 등 포함.
    - **본문**: POST 요청의 경우 데이터 포함.
- 요청 메시지는 서버의 지정된 포트(기본적으로 HTTP: 80, HTTPS: 443)로 전송.
- **port? IP 주소**는 컴퓨터나 장치를 식별하지만, **포트 번호**는 해당 장치 내에서 특정 애플리케이션(프로세스)을 식별

---

## 5. **서버 처리 → HTTP 응답 전송**

요청을 받은 서버는 요청 내용을 분석하고 응답을 생성하여 전송

### **과정**

1. **웹 서버**:
    - 요청이 웹 서버(Apache, Nginx 등)에 도달.
    - 정적 리소스(`HTML`, `CSS`, `JS`)라면 직접 응답.
    - 동적 리소스라면 애플리케이션 서버로 전달.
2. **애플리케이션 서버**:
    - 자바(Spring), Node.js, Python(Django) 등의 애플리케이션 로직 실행.
    - 데이터베이스 조회/갱신 (예: MySQL, MongoDB).
    - 결과를 HTML, JSON, XML 등의 형태로 생성.
3. **응답 메시지** 생성:
    - 상태 코드(200 OK, 404 Not Found 등).
    - 응답 헤더(콘텐츠 유형, 캐시 지시문 등).
    - 응답 본문(HTML, JSON 데이터 등).

---

## 7. **브라우저 렌더링**

브라우저는 받은 응답을 해석하여 화면에 렌더링

### **과정**

1. **HTML 파싱**:
    - HTML 문서를 파싱하며 **DOM 트리** 생성.
    - `<script>`, `<link>`, `<img>` 태그에서 추가 요청(자바스크립트, CSS, 이미지 등)을 발생.
2. **CSS 파싱**:
    - CSS 파일을 받아 **CSSOM 트리** 생성.
3. **자바스크립트 실행**:
    - DOM/CSSOM을 조작하며 동적 렌더링 수행.
4. **렌더 트리 생성 및 그리기**:
    - DOM과 CSSOM을 결합하여 **렌더 트리** 생성.
    - 렌더 트리를 기반으로 브라우저가 화면에 픽셀을 그림.