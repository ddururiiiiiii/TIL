# MySQL InnoDB란?
- MySQL에는 여러 "스토리지 엔진"이 있는데, InnoDB는 그중 가장 많이 쓰이는 기본 저장 엔진
- "MySQL에서 데이터를 어떻게 저장하고 관리할지"를 담당하는 부품!
- 트랜잭션, 롤백, 잠금(lock) 같은 걸 지원

<br>

# 갭 락(Gap Lock)
- 갭 = 실제 행과 행 사이의 "틈", 즉 아직 데이터가 없는 공간
- 갭 락은 이 "틈"에다가 잠금을 걸어, 다른 트랜잭션이 여기다 INSERT 못 하게 막는 것
- 예 )id가 10, 20, 30인 행이 있다고 했을 때
~~~ sql
 SELECT * FROM users WHERE id BETWEEN 10 AND 20 FOR UPDATE;
~~~
- → id=10, id=20 → 행 잠금 -> 10과 20 사이의 갭도 잠금! 👉 갭 락!
- → 그래서 누가 id = 15 INSERT하려고 하면? 갭락때문에 불가능!

<br>

# 넥스트 키 락(Next-Key Lock)
- "갭 락 + 행 락"의 조합 -> 즉, 해당 행 + 그 다음 행 사이 갭까지 잠금
~~~ sql
 SELECT * FROM users WHERE id = 10 FOR UPDATE;
~~~
- → id=10 행 잠금
- → id=10 ~ 20 사이 갭도 잠금 (넥스트 키 락)
- 👉 이걸로 팬텀 리드를 막을 수 있음!


### (+) 추가
- 갭 락과 넥스트 키 락은 모든 DBMS에서 제공되는 기능은 아니고, MySQL의 InnoDB 엔진이 대표적으로 사용하는 특징적인 락 방식
- 의미상 비슷한 기능은 다른 DB에도 있음, 하지만 동작 방식이나 구현은 다름